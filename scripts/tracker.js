console.log("Connected to Tracker.js");var xhr=new XMLHttpRequest;let js_check,image_check,css_check,cookies_on=navigator.cookieEnabled;document.writeln("<img id='js-check'/>"),js_check=null!=document.getElementById("js-check"),image_check=null!=document.getElementById("dummy");let dummy_img=document.getElementById("dummy"),style=window.getComputedStyle(dummy_img),width=style.getPropertyValue("width");css_check="0px"==width;let available_height=window.screen.height*window.devicePixelRatio,available_width=window.screen.width*window.devicePixelRatio,window_height=window.innerHeight,window_width=window.innerWidth,connection_type=navigator.connection.effectiveType,static_data={cookies:cookies_on,js:js_check,img:image_check,css:css_check,avail_h:available_height,avail_w:available_width,win_h:window_height,win_w:window_width,connection:connection_type};var t=window.performance.timing,startTime=t.responseEnd,endTime=t.loadEventEnd,loadTime=endTime-startTime,performance_data={start:startTime,stop:endTime,loadTime:loadTime,pt:t},performanceData=JSON.stringify(performance_data),data=JSON.stringify({userAgent:navigator.userAgent,language:navigator.language,sessionID:document.cookie.split("=")[1],performanceData:performanceData,staticData:JSON.stringify(static_data)});function initRequest(){xhr.onreadystatechange=function(){xhr.readyState===XMLHttpRequest.DONE&&200===xhr.status&&(console.log(xhr.responseText),document.cookie="sessionID="+xhr.responseText)},xhr.open("POST","https://us-central1-cse135-pa3.cloudfunctions.net/postSession",!0),xhr.send(data),console.log("Cookie is "+xhr.response)}let numOpen=window.localStorage.getItem("numOpen")||0;window.onload=function(){0==numOpen&&(this.initRequest(),numOpen++,window.localStorage.setItem("numOpen",numOpen))};let events_list=[];function stringifyEvent(e){const t={};for(let n in e)t[n]=e[n];return JSON.stringify(t,(e,t)=>t instanceof Node?"Node":t instanceof Window?"Window":t," ")}let clickCount=window.localStorage.getItem("click")||1;window.addEventListener("click",e=>{let t=stringifyEvent(e=e||window.event);clickCount++,window.localStorage.setItem("click",clickCount),events_list.push(t)});let mouseoverCount=window.localStorage.getItem("mouseover")||1;window.addEventListener("mouseover",e=>{e=e||window.event,mouseoverCount++,window.localStorage.setItem("mouseover",mouseoverCount),events_list.push(stringifyEvent(e))});let keydown=0,keydownCount=window.localStorage.getItem("keydown")||1;window.addEventListener("keydown",e=>{e=e||window.event,keydownCount++,window.localStorage.setItem("keydown",keydownCount),events_list.push(stringifyEvent(e))});let scroll=0,scrollCount=window.localStorage.getItem("scroll")||1;window.addEventListener("scroll",e=>{e=e||window.event,scrollCount++,window.localStorage.setItem("scroll",scrollCount),events_list.push(stringifyEvent(e))});let beforeUnloadCount=window.localStorage.getItem("unload")||1;window.addEventListener("beforeunload",e=>{e=e||window.event,beforeUnloadCount++,window.localStorage.setItem("unload",beforeUnloadCount),events_list.push(stringifyEvent(e))}),window.onbeforeunload=(e=>{document.URL;let t={events:events_list};console.log("clickCount is "+clickCount);var n=JSON.stringify({userAgent:navigator.userAgent,language:navigator.language,sessionID:document.cookie.split("=")[1],performanceData:performanceData,click:clickCount,mouseover:mouseoverCount,keydown:keydownCount,scroll:scrollCount,beforeUnload:beforeUnloadCount,dynamicData:JSON.stringify(t)});console.log("before sending data"),xhr.onreadystatechange=function(){xhr.readyState===XMLHttpRequest.DONE&&200===xhr.status&&console.log(xhr.responseText)},xhr.open("POST","https://us-central1-cse135-pa3.cloudfunctions.net/postSession",!0),xhr.send(n),console.log(xhr.response)});